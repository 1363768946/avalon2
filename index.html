<!DOCTYPE html>
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="avalon.js"></script>

    </head>
    <body >


        <script>
            function expect(a) {
                return {
                    to: {
                        be: function (b) {
                            console.log(a, b, a === b)
                        }
                    }
                }
            }
            function heredoc(fn) {
                return fn.toString().replace(/^[^\/]+\/\*!?\s?/, '').replace(/\*\/[^\/]+$/, '')
            }
            avalon.config.async = false
            var body = document.body
            var div = document.createElement("div")
            div.innerHTML = heredoc(function () {
                /*
                 <div ms-repeat="$array">{{el}},{{$first}},{{$last}},{{$index}}</div>
                 <hr/>
                 <div ms-repeat="$object">{{$key}}--{{$val}}</div>
                 */
            })
            body.appendChild(div)
            var vm = avalon.define({
                $id: "$array",
                $array: [4, 5, 6, 7],
                $object: {
                    a: 22,
                    b: 33,
                    c: 44
                }
            });
            avalon.scan(div, vm)
            setTimeout(function () {
                var s = div.getElementsByTagName("div")
                expect(s.length).to.be(7)
                expect(s[0].innerHTML).to.be("4,true,false,0")
                expect(s[1].innerHTML).to.be("5,false,false,1")
                expect(s[2].innerHTML).to.be("6,false,false,2")
                expect(s[3].innerHTML).to.be("7,false,true,3")
                expect(s[4].innerHTML).to.be("a--22")
                expect(s[5].innerHTML).to.be("b--33")
                expect(s[6].innerHTML).to.be("c--44")
               // clearTest(vm, div, done)
            }, 150)
        </script>


    </body>

</html>